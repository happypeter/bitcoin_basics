---
layout: paper
---

# 比特币：一个点对点的电子现金系统

注：作者是中本聪，原文链接：<https://bitcoin.org/bitcoin.pdf>， happypeter 翻译。

## 摘要

一个真正的点对点的电子现金系统可以让互联网上的支付直接从一方到达另一方，而不需要中间经过金融机构。电子签名可以提供部分解决方案，但是如果我们还是需要一个可以信任的第三方机构来来避免双花问题，那么这个系统最重要的优势也就体现不出来了。这里，我们提出了一种在点对点网络下解决双花的方案。网络会不断对交易运算哈希，来形成一条不断延长的基于哈希的工作量证明链，比特币网络就是通过这样的形式来给交易加上时间戳的。如果有人想修改交易记录，那么他就必须重新进行哈希运算得到工作量证明。最长的那条链不仅可以用来证明各种事情发生的先后顺序，同时也可以证明自己是来自一个最大的算力池。所以只要掌握大部分算力的节点群体没有协同起来攻击比特币网络，那么最长的链就会由这个群体生成，因为它会比攻击者群体跑的更快。网络本身的几乎不需要考虑组织结构，节点们只需要尽最大的努力广播信息就行了。每个节点都可以随时的加入和退出网络，当重返网络的时候，只要相信那条最长的链就可以了。

## 1. 介绍

互联网上的商家目前在处理电子支付的时候都必须要依赖于第三方的金融机构。大多数时候，这种方式还是可行的，但是始终要受到这种基于信任的模型的拖累。因为避免不了仲裁争议，金融机构无法实现绝对不可逆的交易，调解争议的成本造成了交易成本的增加，导致实际中交易的最小数额不可能太小，这样我们有些很小额的日常交易其实就不能做了，另外一个更大的损失就是，系统没有办法去为那些提供不可逆服务的机构去提供不可逆支付。由于可能存在交易被逆转，对于信任的需求就变得愈发强烈。商家必须非常提防顾客，让他们填写一些本来不是那么必要的信息。 一定比例的欺诈行为被认为是不可避免的。如果采用付现金的方式，这些成本和交易的不确定性是可以避免的，但是还没有一种机制可以让我们摆脱对他人的信任，通过一条通信通道来进行支付。

我们真正需要的是一个不基于信任而基于加密证明的电子支付系统，这样有意愿的交易双方就可以不依赖可信的第三方而直接进行交易了。不可逆转的交易可以防止卖方被欺诈，常规的第三方托管机制则可以让买方得到保护。本论文中，我们提出了解决“双花”问题的解决方案，采用点对点分布式的时间戳服务器去生成用来保证交易时间先后顺序的算力证明。只要所有诚实的节点加起来的运算能力大于协同起来的攻击者节点的运算能力，那么整个系统就是安全的。

## 2. 交易

我们把一枚电子货币定义成一条由许多数字签名形成的链。币的拥有者如果需要把这枚币交易给别人，那么他就拿出上一次交易的哈希加上收款人的公钥，再对这两个东西的结合体做一个数字签名，然后把三者都添加到币的结尾处。收款人可以通过验证签名来验证付款人是否真的拥有这个币。

当然，有一个问题就是收款的人没有办法验证，这个币的之前的持有人中，有没有人把这个币花了两次。通常的解决方案是引入一个可信的中央权威，或是铸币厂，来进行每次交易的双花检查。每次交易之后，这枚币都必须回到铸币厂，然后发放一枚新币，只有直接从铸币厂发出的币我们才能相信是没有被双花过的。这种解决方案的问题就是整个货币系统的命运都依赖于运营铸币厂的那个公司，所有的交易都要经他们的手，这个就和银行没有什么区别了。

我们需要一种方式让收款人知道以前的持有人没有签署过任何更早的交易。大家规定最早的那个交易才是算数的，忽略后面的任何试图进行双花的操作。如何去确认以前确实不存在一个特定交易呢？没有别的办法，只能是让大家知道历史上所有的交易。在基于铸币厂的模型中，铸币厂是知道所有的交易的，所以可以判断出哪次交易首先到达。为了在不依赖于第三方的情况下达成这个效果，各个交易都必须公布给所有人，同时系统要保证可以让大家认可同一个交易顺序。收款人需要有东西可以证明交易发生的时候，大多数的节点都认可这个交易是大家收到的第一个。

## 3. 时间戳服务器

我们提出的方案要开始于构建一个时间戳服务器。时间戳服务器的工作原理是对一个需要被打时间戳的包含很多项内容的区块运算哈希，然后把这个哈希作为时间戳广播出去。这就好比把这个时间戳登到报纸上或者发到论坛里了，让大家去见证它的出现的时刻。时间戳可以证明用来生成它相关的数据在那个时刻已经存在了，不然也不可能运算出这个哈希来。同时，每次生成新时间戳的哈希运算过程中，输入数据都包含着之前的时间戳，这样就形成了一个链条，每个新的时间戳都可以强化印证以前的时间戳的出现的顺序。
